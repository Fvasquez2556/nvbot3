# ğŸ¯ Plan para Preparar NvBot3 para Entrenamiento

## ğŸ“… ** Data Validator (CRÃTICO)**

### **Objetivo:** Asegurar calidad de datos para entrenamiento confiable

### **Tareas:**
1. **Crear `src/data/data_validator.py`**
   - Validar completeness (sin gaps > 2 perÃ­odos)
   - Verificar price validity (no cambios > 50%)
   - Comprobar volume validity (> 0 en 95%+ registros)
   - Detectar outliers extremos
   - Verificar consistencia temporal

2. **Validar datos descargados**
   ```bash
   python scripts/validate_downloaded_data.py --symbol BTCUSDT --timeframe 5m
   python scripts/validate_downloaded_data.py --all-symbols
   ```

3. **Corregir problemas detectados**
   - Forward fill para gaps pequeÃ±os
   - InterpolaciÃ³n para outliers menores
   - Remover datos corruptos irrecuperables

### **Resultado esperado:**
- âœ… Datos limpios y consistentes
- âœ… Reporte de calidad por sÃ­mbolo/timeframe
- âœ… Datasets listos para feature engineering

---

## ğŸ“… ** Feature Calculator**

### **Objetivo:** Calcular ~50 indicadores tÃ©cnicos especÃ­ficos

### **Tareas:**
1. **Crear `src/data/feature_calculator.py`**

2. **Implementar grupos de features:**

   **ğŸ”¥ Para Momentum Alcista (â‰¥5%):**
   ```python
   # Indicadores primarios
   - ROC(14) - Rate of Change
   - ADX(14) - Average Directional Index  
   - MACD(12,26,9) - Moving Average Convergence Divergence
   
   # Indicadores secundarios
   - RSI(14) - Relative Strength Index
   - OBV - On-Balance Volume
   - Bollinger Bands (20,2)
   ```

   **âš¡ Para Rebotes (1-3%):**
   ```python
   - RSI(14) para condiciones oversold
   - MACD Histogram para divergencias
   - Volume patterns (sudden spikes)
   - Support/Resistance levels
   ```

   **ğŸ“Š Para RÃ©gimen de Mercado:**
   ```python
   - ATR(14) - Average True Range
   - Bollinger Bands Width (â‰¤0.20 = consolidaciÃ³n)
   - ADX (< 20 = sideways, > 25 = trending)
   - Moving Average slopes (SMA 20,50,200)
   ```

3. **Validar features calculadas**
   ```bash
   python scripts/calculate_features.py --symbol BTCUSDT --timeframe 5m
   python scripts/validate_features.py --check-correlations
   ```

### **Resultado esperado:**
- âœ… 50+ indicadores tÃ©cnicos calculados
- âœ… Features especÃ­ficas para cada objetivo
- âœ… Datasets enriquecidos listos para targets

---

## ğŸ“… ** Target Creator**

### **Objetivo:** Definir exactamente quÃ© debe predecir cada modelo

### **Tareas:**
1. **Crear `src/data/target_creator.py`**

2. **Implementar targets especÃ­ficos:**

   **ğŸ¯ Momentum Target:**
   ```python
   def create_momentum_target(close_prices, lookforward_periods=48):
       # Buscar mÃ¡ximo precio en prÃ³ximos 48 perÃ­odos (4 horas en 5m)
       # Target = 1 si (max_future_price / current_price) >= 1.05
       # Target = 0 en caso contrario
       # DistribuciÃ³n esperada: ~15-20% positivos
   ```

   **ğŸ¯ Rebound Target:**
   ```python
   def create_rebound_target(close_prices, lookforward_periods=24):
       # Buscar rebote de 1-3% en prÃ³ximos 24 perÃ­odos (2 horas en 5m)
       # Target = 1 si rebote estÃ¡ en rango 1%-3%
       # Target = 0 si rebote < 1% o > 3%
       # DistribuciÃ³n esperada: ~10-15% positivos
   ```

   **ğŸ¯ Regime Target:**
   ```python
   def create_regime_target(prices, periods=96):
       # Analizar tendencia en prÃ³ximos 96 perÃ­odos (8 horas en 5m)
       # 0 = Bearish (tendencia bajista)
       # 1 = Sideways (consolidaciÃ³n)  
       # 2 = Bullish (tendencia alcista)
       # DistribuciÃ³n esperada: 30/40/30%
   ```

3. **Validar distribuciÃ³n de targets**
   ```bash
   python scripts/create_targets.py --symbol BTCUSDT --timeframe 5m
   python scripts/analyze_target_distribution.py --all-targets
   ```

### **Resultado esperado:**
- âœ… 3 tipos de targets bien definidos
- âœ… DistribuciÃ³n balanceada (no 99% negativos)
- âœ… Datasets completos listos para entrenamiento

---

## ğŸ“… ** Model Trainer**

### **Objetivo:** Pipeline completo de entrenamiento con anti-overfitting

### **Tareas:**
1. **Crear `scripts/train_models.py`**
   - Entrenar 3 modelos especializados
   - Aplicar walk-forward validation
   - Detectar overfitting automÃ¡ticamente

2. **Entrenar modelos especÃ­ficos:**
   ```python
   # Momentum Detector (XGBoost + RandomForest ensemble)
   python scripts/train_models.py --model momentum --symbol BTCUSDT
   
   # Rebound Predictor (LSTM temporal)
   python scripts/train_models.py --model rebound --symbol ETHUSDT
   
   # Regime Classifier (SVM multiclass)
   python scripts/train_models.py --model regime --symbol BNBUSDT
   ```

3. **ValidaciÃ³n exhaustiva:**
   ```bash
   python scripts/validate_trained_models.py --test-period 6months
   python scripts/backtest_signals.py --start-date 2024-01-01
   ```

### **Resultado esperado:**
- âœ… 3 modelos entrenados y validados
- âœ… Performance > 75% en momentum detection
- âœ… Sistema completo listo para seÃ±ales reales

---

## ğŸ¯ **OBJETIVOS DE PERFORMANCE FINALES**

### **Momentum Alcista (â‰¥5%):**
- **PrecisiÃ³n:** >75% 
- **Recall:** >60%
- **False positives:** <20%

### **Rebotes (1-3%):**
- **PrecisiÃ³n:** >70%
- **Timing:** Detectar en primeras 2 horas
- **Risk/Reward:** >1:2

### **RÃ©gimen de Mercado:**
- **Accuracy multiclass:** >65%
- **DetecciÃ³n de cambios:** <4 horas delay
- **Consistency:** >80% en diferentes timeframes

---

## âš ï¸ **CONSIDERACIONES CRÃTICAS**

### **ğŸ›¡ï¸ Anti-overfitting obligatorio:**
- Walk-forward validation en cada paso
- RegularizaciÃ³n agresiva en todos los modelos
- Validation temporal estricta (nunca random splits)

### **ğŸ’» OptimizaciÃ³n para laptop:**
- MÃ¡ximo 4 threads simultÃ¡neos
- Procesamiento en lotes para memoria
- Cache inteligente de features calculadas

### **ğŸ“Š Calidad de seÃ±ales:**
- Mejor 5 seÃ±ales precisas que 50 imprecisas
- ClasificaciÃ³n de confianza: baja/media/alta
- SeÃ±ales manuales (humano toma decisiÃ³n final)

### **ğŸ”„ Reentrenamiento automÃ¡tico:**
- Reentrenar cada 2 semanas con nuevos datos
- Detectar degradaciÃ³n de performance
- Alertas automÃ¡ticas cuando precisiÃ³n < 65%

---

## ğŸš€ **CRONOGRAMA RESUMIDO**

	      Componente     | Estado Actual    | Objetivo                |
|-------|--------------------|------------------|-------------------------|
| **1** | Data Validator     | âŒ No existe    | âœ… Datos validados     |
| **2** | Feature Calculator | âŒ No existe    | âœ… 50+ features        |
| **3** | Target Creator     | âŒ No existe    | âœ… 3 targets definidos |
| **4** | Model Trainer      | âš ï¸ Base parcial | âœ… Modelos entrenados  |

### **ğŸ¯ Meta Final:**
- Detectar momentums alcistas â‰¥5% con >75% precisiÃ³n
- Predecir rebotes 1-3% con timing preciso
- Clasificar rÃ©gimen de mercado en tiempo real
- Generar seÃ±ales manuales confiables para trading
